let obj = [{
    dish: 'Pizza Pepperoni',
    ingredients: ['pepperoni', 'dought', 'mozzarela', 'tomato sauce'],
    img: 'photo/pizza_pepperoni.jpg'
}, {
    dish: 'Omlet',
    ingredients: ['eggs', 'oil'],
    img: 'photo/omlet.jpg'
},
{
    dish: 'Pasta with parmesan',
    ingredients: ['spaghetti', 'parmesan', 'oil'],
    img: 'photo/pasta.jpg'
},
{
    dish: 'Khinkali with beef',
    ingredients: ['dought', 'beef', 'onion'],
    img: 'photo/beef_khinkali.jpg'
},
{
    dish: 'Fried Salmon with lemon',
    ingredients: ['salmon', 'lemon', 'oil'],
    img: 'photo/fried_salmon_with_lemon.jpg'
},
{
    dish: 'Acharian khachapuri',
    ingredients: ['cheese', 'dought', 'eggs', 'butter'],
    img: 'photo/acharian_khachapuri.jpeg'
},
{
    dish: 'Beef steak',
    ingredients: ['beef', 'oil'],
    img: 'photo/beef_steak.jpg'
},
{
    dish: 'Chicken cutlets',
    ingredients: ['chicken breast', 'eggs', 'oil', 'flour'],
    img: 'photo/chicken_cutlets.jpg'
},
{
    dish: 'Caesar salad',
    ingredients: ['lettuce', 'parmesan', 'chicken breast', 'croutons', 'lemon', 'mayo'],
    img: 'photo/ceasar_salad.jpg'
},
{
    dish: 'Chicken Tabaka',
    ingredients: ['chicken', 'oil', 'tkemali sauce'],
    img: 'photo/chicken_tabaka.jpg'
},
{
    dish: 'Rice with carrot',
    ingredients: ['rice', 'carrot', 'onion', 'garlic'],
    img: 'photo/rice_with_carrot.jpg'
},
{
    dish: 'McDonalds cheeseburger',
    ingredients: ['beef', 'oil', 'cheese', 'burger buns', 'onion', 'ketchup', 'tomato', 'pickle', 'lettuce'],
    img: 'photo/mcdonalds_cheeseburger.jpg'
},
{
    dish: 'Greek salad',
    ingredients: ['onion', 'feta cheese', 'tomato', 'olives', 'lemon', 'cucumber', 'oil'],
    img: 'photo/greek_salad.jpg'
},
{
    dish: 'Pelmeni',
    ingredients: ['beef', 'onion', 'pork', 'flour', 'eggs', 'sour cream'],
    img: 'photo/pelmeni.jpg'
},
{
    dish: 'Buckwheat',
    ingredients: ['buckwheat'],
    img: 'photo/buckwheat.jpg'
},
{
    dish: 'French fries',
    ingredients: ['potato', 'oil'],
    img: 'photo/french_fries.jpg'
},
{
    dish: 'Chicken shawarma',
    ingredients: ['chicken breast', 'tomato', 'ketchup', 'mayo', 'lettuce', 'lavash bread', 'onion'],
    img: 'photo/chicken_shawarma.jpg'
},
{
    dish: 'Pork shawarma',
    ingredients: ['pork', 'tomato', 'ketchup', 'mayo', 'lettuce', 'lavash bread', 'onion'],
    img: 'photo/pork_shawarma.jpg'
},
{
    dish: 'Chicken noodles',
    ingredients: ['chicken breast', 'noodles', 'soya sauce', 'oil', 'garlic', 'bell pepper', 'onion', 'cabbage', 'green beans'],
    img: 'photo/noodles_with_chicken.jpg'
},
{
    dish: 'Imeretian khachapuri',
    ingredients: ['cheese', 'flour', 'eggs'],
    img: 'photo/imeretian_khachapuri.jpg'
},
{
    dish: 'Megrelian khachapuri',
    ingredients: ['cheese', 'eggs', 'butter', 'flour'],
    img: 'photo/megrelian_khachapuri.jpg'
},
{
    dish: 'Lobiani khachapuri',
    ingredients: ['beans', 'flour', 'eggs', 'butter'],
    img: 'photo/lobiani_khachapuri.jpg'
},
{
    dish: 'Salmon rolls',
    ingredients: ['salmon', 'ginger', 'soya sauce', 'nori', 'rice', 'cucumber', 'cream-cheese'],
    img: 'photo/salmon_rolls.jpg'
},
{
    dish: 'Philadelphia rolls',
    ingredients: ['salmon', 'soya sauce', 'cucumber', 'avocado', 'cream-cheese', 'nori', 'rice'],
    img: 'photo/philapelphia_rolls.jpg'
},
{
    dish: 'Pizza Diablo',
    ingredients: ['champignon', 'ham', 'dought', 'bell pepper', 'chili pepper', 'cheese', 'tomato sauce'],
    img: 'photo/pizza_diablo.jpg'
},
{
    dish: 'Pizza veggie',
    ingredients: ['olives', 'dought', 'tomato sauce', 'tomato', 'champignon', 'bell pepper'],
    img: 'photo/pizza_veggie.jpg'
},
{
    dish: 'Pasta Bolognese',
    ingredients: ['spaghetti', 'parmesan', 'carrot', 'beef', 'oil'],
    img: 'photo/pasta_bolognese.jpg'
},
{
    dish: 'Pasta Carbonara',
    ingredients: ['spaghetti', 'parmesan', 'ham', 'eggs', 'cream'],
    img: 'photo/pasta_carbonara.jpg'
},
{
    dish: 'Borscht',
    ingredients: ['beetroot', 'sour cream', 'onion', 'beef', 'oil', 'potato', 'cabbage'],
    img: 'photo/borscht.jpg'
},
{
    dish: 'Eggplant with walnuts',
    ingredients: ['walnuts', 'eggplant', 'garlic', 'oil', 'paprika'],
    img: 'photo/eggplant_with_walnuts.jpg'
},
{
    dish: 'Fried trout',
    ingredients: ['trout', 'oil', 'lemon'],
    img: 'photo/fried_trout.jpg'
},
{
    dish: 'Mexican potatoes with sauce',
    ingredients: ['potato', 'oregano', 'paprika', 'oil', 'garlic', 'sour cream'],
    img: 'photo/mexican_potatoes_with_sauce.jpeg'
},
{
    dish: 'Chicken salad',
    ingredients: ['chicken breast', 'lettuce', 'mayo', 'champignon', 'canned corn', 'bell pepper'],
    img: 'photo/chicken_salad.jpg'
},
{
    dish: 'Salad Olivier',
    ingredients: ['potato', 'carrot', 'eggs', 'mayo', 'pickle', 'pea'],
    img: 'photo/salad_olivier.png'
},
{
    dish: 'Kaurma',
    ingredients: ['beef liver', 'onion', 'oil', 'beef heart'],
    img: 'photo/kaurma.jpg'
},
{
    dish: 'Hot dog',
    ingredients: ['sausage', 'mayo', 'hot dog buns', 'mustard', 'onion', 'ketchup'],
    img: 'photo/hotdog.jpg'
},
{
    dish: 'Dolma',
    ingredients: ['beef', 'rice', 'grape leaves', 'tomato sauce', 'onion', 'oil'],
    img: 'photo/dolma.jpg'
},
{
    dish: 'Summer Tolma',
    ingredients: ['beef', 'tomato', 'eggplant', 'bell pepper', 'tomato sauce', 'cabbage', 'rice', 'oil', 'onion'],
    img: 'photo/summer_tolma.jpg'
},
{
    dish: 'Tolma with cabbage',
    ingredients: ['beef', 'rice', 'cabbage', 'oil', 'tomato sauce', 'onion'],
    img: 'photo/tolma_with_cabbage.jpg'
},
{
    dish: 'Puree',
    ingredients: ['potato', 'oil', 'butter'],
    img: 'photo/puree.jpg'
},
{
    dish: 'Macaroni with matsoni & garlic',
    ingredients: ['macaroni', 'matsoni', 'garlic', 'oil'],
    img: 'photo/macaroni_with_matsoni_and_garlic.jpg'
},
{
    dish: 'Pancakes with meat',
    ingredients: ['beef', 'milk', 'flour', 'oil', 'eggs', 'onion', 'butter'],
    img: 'photo/pancakes_with_meat.jpg'
},
{
    dish: 'French lamb stew',
    ingredients: ['mutton', 'tomato', 'carrot', 'pea', 'butter', 'flour', 'potato', 'oil', 'onion', 'garlic'],
    img: 'photo/french_lamb_stew.jpg'
},
{
    dish: 'Lamb pilaf',
    ingredients: ['mutton', 'garlic', 'onion', 'rice', 'carrot', 'raisin', 'oil'],
    img: 'photo/lamb_pilaf.jpg'
},
{
    dish: 'Fried chicken gizzard',
    ingredients: ['chicken gizzard', 'oil', 'onion', 'garlic'],
    img: 'photo/fried_chicken_gizzard.jpg'
},
{
    dish: 'Salad with ham & mushrooms',
    ingredients: ['ham', 'champignon', 'mayo', 'oil', 'cheese', 'eggs'],
    img: 'photo/salad_with_ham_and_mushrooms.jpg'
},
{
    dish: 'Mushrooms with vegetables',
    ingredients: ['champignon', 'broccoli', 'green onion', 'carrot', 'oil'],
    img: 'photo/mushrooms_with_vegetables.jpg'
},
{
    dish: 'Champingnons with cheese',
    ingredients: ['champignon', 'cream-cheese', 'butter', 'garlic'],
    img: 'photo/champingnons_with_cheese.jpg'
},
{
    dish: 'Spicy baked chicken legs',
    ingredients: ['chicken legs', 'paprika', 'oil'],
    img: 'photo/baked_chickenlegs.jpg'
},
{
    dish: 'Carrot salad',
    ingredients: ['carrot', 'garlic', 'mayo'],
    img: 'photo/carrot_salad.jpg'
},
{
    dish: 'Herring',
    ingredients: ['herring', 'vinegar', 'oil', 'onion', 'lemon'],
    img: 'photo/herring.jpg'
},
{
    dish: 'Herring in an overcoat',
    ingredients: ['herring', 'eggs', 'potato', 'mayo', 'beetroot', 'carrot', 'onion'],
    img: 'photo/herring_in_an_overcoat.jpg'
},
{
    dish: 'Fried squid',
    ingredients: ['squid', 'oil', 'flour'],
    img: 'photo/fried_squid.jpg'
},
{
    dish: 'Chicken bouillon soup',
    ingredients: ['vermicelli', 'chicken', 'carrot', 'potato', 'onion'],
    img: 'photo/chicken_bouillon_soup.jpg'
},
{
    dish: 'Red kidney bean stew',
    ingredients: ['beans', 'oil', 'tkemali sauce', 'onion'],
    img: 'photo/red_kidney_bean_stew.jpg'
},
{
    dish: 'Green beans with tomatoes',
    ingredients: ['green beans', 'tomato', 'onion', 'garlic', 'oil'],
    img: 'photo/green_beans_with_tomatoes.jpg'
},
{
    dish: 'Okroshka',
    ingredients: ['potato', 'eggs', 'cucumber', 'radish', 'green onion', 'kefir'],
    img: 'photo/okroshka.jpg'
},
{
    dish: 'Ajapsandali',
    ingredients: ['potato', 'eggplant', 'tomato', 'tomato sauce', 'bell pepper', 'onion', 'oil', 'garlic'],
    img: 'photo/ajapsandali.jpg'
},
{
    dish: 'Satsivi',
    ingredients: ['chicken', 'walnuts', 'garlic', 'onion'],
    img: 'photo/satsivi.jpg'
},
{
    dish: 'Beef cutlets',
    ingredients: ['beef', 'oil', 'onion', 'potato', 'eggs'],
    img: 'photo/beef_cutlets.jpg'
},
{
    dish: 'Vinaigrette salad',
    ingredients: ['beetroot', 'carrot', 'sauerkraut', 'pickle', 'potato', 'beans', 'onion', 'vinegar', 'oil'],
    img: 'photo/vinaigrette_salad.jpg'
},
{
    dish: 'Crab salad',
    ingredients: ['eggs', 'canned corn', 'crab sticks', 'rice', 'mayo', 'cucumber'],
    img: 'photo/crab_salad.jpg'
},
{
    dish: 'Fried squash with mayo',
    ingredients: ['squash', 'mayo', 'oil', 'eggs', 'bread crumbs'],
    img: 'photo/fried_squash_with_mayo.jpg'
},
{
    dish: 'Fried cauliflower',
    ingredients: ['cauliflower', 'eggs', 'oil', 'bread crumbs'],
    img: 'photo/fried_cauliflower.jpg'
},
{
    dish: 'Pork steak',
    ingredients: ['pork', 'oil'],
    img: 'photo/pork_steak.jpg'
},
{
    dish: 'Shrimps with rice',
    ingredients: ['rice', 'shrimps', 'oil', 'soya sauce', 'snow peas', 'garlic', 'bell pepper'],
    img: 'photo/shrimps_with_rice.jpg'
},
{
    dish: 'Boiled corn',
    ingredients: ['corn'],
    img: 'photo/boiled_corn.jpg'
},
{
    dish: 'Spinach with walnuts (Pkhali)',
    ingredients: ['spinach', 'walnuts', 'garlic', 'vinegar', 'pomegranate'],
    img: 'photo/pkhali.jpg'
},
{
    dish: 'Sandwich with cheese & ham',
    ingredients: ['bread', 'ham', 'cheese', 'tomato', 'pickle', 'lettuce'],
    img: 'photo/sandwich_with_cheese_and_ham.jpg'
},
{
    dish: 'Mchadi',
    ingredients: ['cornmeal', 'oil', 'cheese'],
    img: 'photo/mchadi.jpg'
}];

let catalog = document.getElementById('catalog');
let allIngrArr = [];
function allIngr() {
    for (let i = 0; i < obj.length; i++) {
        for (let j = 0; j < obj[i]['ingredients'].length; j++) {
            allIngrArr.push(obj[i]['ingredients'][j]);
        }
    }
    allIngrArr = [...new Set(allIngrArr)]; // leave only unique ingredients.
    allIngrArr.sort(function (a, b) {
        return a === b ? 0 : a < b ? -1 : 1;
    }); // sorts alphabetically 
    for (let n = 0; n < allIngrArr.length; n++) {
        catalog.innerHTML += "<p class='cl-catalog'>" + allIngrArr[n] + "</p >" // making catalog
    }
} // - this function will make catalog with ingredients for us

allIngr();

let search = document.getElementById('search');
let catalogForSearch = document.querySelectorAll('.cl-catalog');

search.oninput = function () {
    let val = this.value.trim();
    if (val != '') {
        catalogForSearch.forEach(function (element) {
            if (element.textContent.search(val) == -1) {
                element.classList.add('hide');
            } else {
                element.classList.remove('hide');
            }
        });
    } else {
        catalogForSearch.forEach(function (element) {
            element.classList.remove('hide');
        });
    }
} // - our search function, with that function user will easily find his ingredients.


let chosenNumber = document.querySelector('h4 p');
function clickGreen() {
    let counter = 0;
    catalog.addEventListener('click', function (e) {
        if (e.target.style.backgroundColor == '' && e.target.className == 'cl-catalog') {
            e.target.style.backgroundColor = 'green';
            counter++;
            chosenNumber.innerHTML = "Choosen ingredients:" + counter; // will count chosen ingridients if it's green(chosen)
        } else if (e.target.style.backgroundColor == 'green') {
            e.target.style.backgroundColor = '';
            counter--;
            chosenNumber.innerHTML = "Choosen ingredients:" + counter; // will substract chosen ingridients if it was chosen but then user changed his mind
        }
    });
}// this function will let us choose ingredients from catalog and change ingredients color to green if it was choosen and to '' if it wasn't.

clickGreen();

let button = document.getElementById('bt');
let answer = document.getElementById('answer');
let catalogItemsP = document.getElementsByClassName('cl-catalog');
let addMore = document.getElementById('addMore');
let addMoreFirstP = document.getElementById('addMoreFirstP');
function clickOnButton() {
    button.addEventListener('click', function () {
        answer.innerHTML = ''; // - will reset our dishes if user will use our programm many times
        addMore.innerHTML = '';// - reset
        let array = []; // - will reset an array if user will use our programm many times
        let dishArr = []; // - reset
        let addMoreDish = [];// - reset
        let addMoreIngr = [];// - reset
        addMoreFirstP.style.display = 'none';// - reset
        for (let i = 0; i < catalogItemsP.length; i++) {
            if (catalogItemsP[i].style.backgroundColor == 'green') {
                array.push(catalogItemsP[i].textContent);
            }
        }// checks which ingredients were choosen and push them to a new array (array) these are ingredients that user has.
        for (let i = 0; i < obj.length; i++) {
            let counter = 0;
            let ingrLength = obj[i]['ingredients'].length;
            for (let j = 0; j < array.length; j++) {
                if (obj[i]['ingredients'].indexOf(array[j]) !== -1) {
                    counter++;
                }
            }// checks how much ingredients which were choosen in previous step (array) includes our dishes in global object (obj) and then add +1 to a counter.
            if (counter == ingrLength) {
                dishArr.push(obj[i]['dish']);
                dishArr.sort(() => Math.random() - 0.5) // will shuffle an array
            } // if our dish (obj[i]['dish']) has all needable ingredients (counter == ingrLength) we will push that dish to our dishArr array. So we will have collection of dishes what we can make with our stack of ingredients.
            else if (counter != ingrLength && counter * 100 / ingrLength >= 65) {
                addMoreDish.push(obj[i]['dish']);
                addMoreDish.sort(() => Math.random() - 0.5);// shuffle
            } // that function will save that dishes in addMoreDish array which had at least 65% of needable ingredients but not 100%.
        }
        if (dishArr.length == 0 && addMoreDish.length == 0) {
            answer.innerHTML = "<p class='notEnough-Ingr'>Buy more ingredients please</p>"; // if we have very small stack of ingredients and we can cook anything with that, we will get the message - Buy more ingredients please
        } else {
            for (let i = 0; i < dishArr.length; i++) {
                for (let j = 0; j < obj.length; j++) {
                    if (obj[j]['dish'] == dishArr[i]) {
                        let makeSpace = obj[j]['ingredients'].map(function (item) { // here we are making new array where our dishes ingredients will be sorted with space at the beggining (it will help us to avoid very long sentences).
                            return item.replace(/([a-z])/, ' $1');
                        });// There I am making spaces at start for every ingredient in array, so my paragraph of ingredients won't be one word and everything will fit well in my divs.
                        answer.innerHTML += "<div class='cl-answer'><h1>" + dishArr[i] + "</h1><p> <span>Ingredients: </span>" + makeSpace + "</p><img class='image' src='" + obj[j]['img'] + "' alt=''></div>"
                    }
                }
            }// that function will make our answer list with dishes(including photo) and their ingredients which had 100% compatibility with users ingredients stack.
            if (addMoreDish.length > 0) {
                addMoreFirstP.innerHTML = '<a href="#addMoreFirstP">*You can cook more dishes (' + addMoreDish.length + ') </a> ';
                addMoreFirstP.style.display = 'flex'; // we will display addMoreFirstP if we will have at least 1 dish in the addMoreDish array and that addMoreFirstP will be clickable to show us all dishes in future.
                for (let i = 0; i < addMoreDish.length; i++) {
                    for (let j = 0; j < obj.length; j++) {
                        if (obj[j]['dish'] == addMoreDish[i]) {
                            addMoreIngr = []; // that array hasn't been used yet. only declared
                            for (let n = 0; n < obj[j]['ingredients'].length; n++) {
                                if (array.indexOf(obj[j]['ingredients'][n]) == -1) {
                                    addMoreIngr.push(obj[j]['ingredients'][n]);
                                }
                            }// that part will find ingredinets that user needs to add to cook dishes in addMoreDish array (remember 65%).
                            let makeSpace = addMoreIngr.map(function (item) { // here we are making new array where our dishes ingredients will be sorted with space at the beggining (it will help us to avoid very long sentences).
                                return item.replace(/([a-z])/, ' $1');
                            });
                            addMore.innerHTML += "<div style='display:none;' class='addMore-answer'><h1>" + addMoreDish[i] + "</h1><p> <span>Need to add: </span>" + makeSpace + "</p><img class='image' src='" + obj[j]['img'] + "' alt=''></div>"
                        }
                    }
                }
            } // that function will make new answer list with dishes(including photo) and ingredients what user needs to add. there will be dishes which have at least 65% compatibility with users ingredients stack.
        }
    })
} // - main code which should generate dishes.

addMoreFirstP.addEventListener('click', function () {
    let collection = [];
    collection = addMore.children;
    for (let i = 0; i < collection.length; i++) {
        if (collection[i].style.display == 'none') {
            collection[i].style.display = 'flex';
        } else {
            collection[i].style.display = 'none';
        }
    }
}) // will make addMoreFirstP clickable to show us more dishes which user can cook if he add some more ingredients.

clickOnButton()












